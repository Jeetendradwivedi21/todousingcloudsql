steps:
- name: 'gcr.io/cloud-builders/gcloud'
  args:
  - 'compute'
  - 'ssh'
  - 'jeetendra@instance-2'
  - '--zone'
  - 'us-central1-a'
  - '--command'
  - |
    while fuser /var/lib/dpkg/lock-frontend >/dev/null 2>&1 ; do
        sleep 1
    done

    # Update and install Go
    sudo apt-get update
    sudo apt-get install -y golang

    # Add Go to the PATH and execute the build script
    export PATH=$PATH:/usr/lib/go/bin
    cd /home/jeetendra/todousingcloudsql
    go build main.go
    ./main

options:
  logging: 'CLOUD_LOGGING_ONLY'
substitutions:
  _CLOUDSDK_COMPUTE_ZONE: 'us-central1-a'
  _CLOUDSDK_CORE_PROJECT: 'handy-zephyr-403110'
